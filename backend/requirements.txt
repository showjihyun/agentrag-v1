# Core Framework
fastapi>=0.109.0
uvicorn[standard]>=0.27.0
pydantic>=2.7.4,<3.0.0
pydantic-settings>=2.1.0
python-multipart>=0.0.6
email-validator>=2.0.0

# LLM and Agent Orchestration (Numpy 2.x compatible - Fixed versions)
langchain==0.3.19  # Required by langchain-community 0.3.18
langchain-community==0.3.18
langchain-core==0.3.37  # Required by langchain-community 0.3.18
langgraph==0.2.55
langsmith==0.3.45  # Required by langchain-core 0.3.37+
litellm==1.17.9  # LLM provider abstraction (Ollama, OpenAI, Claude)

# Embeddings (Numpy 2.x compatible - Fixed versions)
transformers==4.44.2  # Hugging Face transformers (stable, numpy 2.x compatible)
sentence-transformers==3.0.1  # Sentence embeddings (stable, numpy 2.x compatible)
torch>=2.0.0
torchvision>=0.15.0

# Hybrid Search
rank-bm25==0.2.2

# Korean Language Support (optional but recommended)
konlpy==0.6.0

# Reranking (Cross-encoder)
# Note: This will download additional models (~100MB)
# Comment out if you don't need reranking
# sentence-transformers already includes CrossEncoder

# Vector Database
# Milvus runs in Docker (agenticrag-milvus container)
# Start with: docker-compose up -d milvus
# Install grpcio first to avoid compilation: pip install --only-binary=:all: grpcio
pymilvus>=2.6.0  # Uses pre-built grpcio (no compilation needed)

# Database (Phase 5)
sqlalchemy==2.0.23
psycopg2-binary==2.9.9
asyncpg>=0.30.0
alembic==1.12.1

# Authentication (Phase 5)
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4

# Cache and Session
redis==5.0.1

# Scheduling
apscheduler==3.10.4
croniter==2.0.1

# OCR - EasyOCR (GPU supported, no protobuf conflict)
# Note: PaddleOCR removed due to protobuf conflict with pymilvus
# pymilvus requires protobuf>=5.27.2, paddlepaddle-gpu requires protobuf<=3.20.2
# EasyOCR provides excellent OCR with GPU support and no conflicts
shapely>=2.0.0  # Required by OCR
pyclipper>=1.3.0  # Required by OCR
opencv-python>=4.8.0  # Required by OCR
Pillow>=10.0.0  # Image processing

# MCP Integration
# Note: MCP servers are optional and can be run separately
# If you need MCP functionality, uncomment the line below:
# mcp>=1.0.0
# For now, MCP functionality will be disabled if not installed

# Web Search
duckduckgo-search>=6.0.0  # DuckDuckGo search API

# Utilities
python-dotenv>=1.0.1,<2.0.0
aiofiles==23.2.1
pypdf2==3.0.1
opendataloader-pdf>=0.1.0  # For better PDF table extraction
python-docx==1.1.2  # Required by docling 2.14.0
python-pptx==1.0.2  # For PowerPoint file parsing (required by docling 2.14.0)
olefile==0.47  # For HWP file parsing
pyhwp==0.1b12  # Better HWP parsing (optional, may have compatibility issues)
psutil==5.9.8  # For system monitoring

# HTTP and Web
httpx==0.27.0  # Async HTTP client (latest stable)
requests==2.32.3  # HTTP library (required by docling 2.14.0)
beautifulsoup4==4.12.3  # HTML parsing (if needed)

# Scientific Computing (Numpy 2.x REQUIRED - Fixed version)
numpy==2.1.3  # Stable numpy 2.x version
scikit-learn==1.5.2  # For cosine similarity and ML utilities

# Image Processing (OCR - Fixed versions)
easyocr==1.7.2  # Multi-language OCR with GPU support
pillow==10.4.0  # Image processing library
opencv-python==4.10.0.84  # Computer vision (numpy 2.x compatible)
nest-asyncio==1.6.0  # Nested event loop support for async OCR

# Advanced Document Processing (Docling - Fixed versions)
docling==2.14.0  # IBM Research document processing (tables, charts, layout)
pdf2image==1.17.0  # PDF to image conversion for Docling
poppler-utils; platform_system != "Windows"  # PDF rendering (Linux/Mac)

# Knowledge Graph (Priority 4)
networkx==3.2.1  # For knowledge graph and entity relationships

# Retry and Resilience
tenacity==8.2.3  # Retry logic for LLM calls

# Security - Restricted Code Execution
RestrictedPython==7.0  # Secure Python code execution for logic blocks
cryptography>=41.0.0  # Encryption for secrets management
bleach>=6.0.0  # HTML sanitization for XSS prevention

# Token Management
tiktoken==0.5.2  # Token counting for LLM optimization

# Testing
pytest==7.4.0
pytest-asyncio==0.21.1
pytest-cov==4.1.0
pytest-mock==3.12.0
locust==2.15.1  # Performance testing

# Language detection for metadata extraction
langdetect==1.0.9

# Character encoding detection
chardet==5.2.0

# Excel file support
openpyxl==3.1.5  # For XLSX files (required by docling 2.14.0)
xlrd==2.0.1  # For XLS files

# Production server
gunicorn==21.2.0  # WSGI server for production

# Document Processing
PyMuPDF>=1.23.0  # PDF processing and rendering
python-docx>=1.1.0  # DOCX processing
python-pptx>=0.6.23  # PPTX processing

# ============================================
# Notification & Monitoring Services
# ============================================

# Email Services
sendgrid>=6.10.0  # SendGrid email API
boto3>=1.34.0  # AWS SDK (for SES email)

# Error Tracking
sentry-sdk[fastapi]>=1.40.0  # Sentry error tracking with FastAPI integration

# Structured Logging (Phase 2)
structlog>=24.1.0  # Structured logging with context

# Distributed Tracing (Phase 2)
opentelemetry-api>=1.20.0  # OpenTelemetry API
opentelemetry-sdk>=1.20.0  # OpenTelemetry SDK
opentelemetry-instrumentation-fastapi>=0.41b0  # FastAPI instrumentation
opentelemetry-instrumentation-sqlalchemy>=0.41b0  # SQLAlchemy instrumentation
opentelemetry-instrumentation-redis>=0.41b0  # Redis instrumentation
opentelemetry-instrumentation-httpx>=0.41b0  # HTTPX instrumentation
opentelemetry-exporter-jaeger>=1.20.0  # Jaeger exporter

# PDF Export
reportlab>=4.0.0  # PDF generation library
